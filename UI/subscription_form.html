<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeuroFace AI - Institution Registration</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background: #0a0a0a;
            color: #ffffff;
            min-height: 100vh;
        }
        
        .font-display {
            font-family: 'Inter', sans-serif;
            font-weight: 700;
        }
        
        .text-gradient {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .bg-gradient {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.05) 100%);
        }
        
        .feature-card {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            background: rgba(30, 30, 30, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .feature-card:hover {
            transform: translateY(-10px);
            border-color: #6366f1;
            box-shadow: 0 20px 40px rgba(99, 102, 241, 0.2);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 40px rgba(99, 102, 241, 0.3);
        }
        
        .btn-secondary {
            background: rgba(99, 102, 241, 0.1);
            border: 1px solid rgba(99, 102, 241, 0.3);
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            background: rgba(99, 102, 241, 0.2);
            border-color: #6366f1;
            transform: translateY(-2px);
        }
        
        .payment-card {
            background: rgba(30, 30, 30, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        .payment-card:hover {
            border-color: #6366f1;
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.2);
        }
        
        .payment-card.selected {
            border-color: #6366f1;
            box-shadow: 0 0 30px rgba(99, 102, 241, 0.3);
            background: rgba(99, 102, 241, 0.05);
        }
        
        input, textarea, select {
            background: rgba(30, 30, 30, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        .form-step {
            opacity: 0.5;
            transform: scale(0.95);
            transition: all 0.3s ease;
        }
        
        .form-step.active {
            opacity: 1;
            transform: scale(1);
        }
        
        .logo-img {
            height: 70px;
            width: auto;
            transition: all 0.3s ease;
        }
        
        .logo-img:hover {
            transform: scale(1.05);
        }
        
        .progress-bar {
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #6366f1, #8b5cf6);
            transition: width 0.3s ease;
        }
        
        .neural-line {
            position: absolute;
            background: linear-gradient(90deg, transparent, #6366f1, transparent);
            height: 1px;
            width: 100%;
            animation: neural-flow 3s linear infinite;
        }
        
        @keyframes neural-flow {
            0% { transform: translateX(-100%); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translateX(100%); opacity: 0; }
        }
        
        .pulse-glow {
            animation: pulse-glow 2s ease-in-out infinite;
        }
        
        @keyframes pulse-glow {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .payment-method-form {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease, opacity 0.3s ease;
            opacity: 0;
        }
        
        .payment-method-form.active {
            max-height: 500px;
            opacity: 1;
        }
        
        .password-rule {
            transition: all 0.3s ease;
        }
        
        .password-rule.valid {
            color: #10b981;
        }
        
        .password-rule.invalid {
            color: #ef4444;
        }
        
        .password-strength {
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            overflow: hidden;
            margin-top: 8px;
        }
        
        .password-strength-fill {
            height: 100%;
            border-radius: 2px;
            transition: all 0.3s ease;
        }
        
        .password-weak {
            background: #ef4444;
            width: 25%;
        }
        
        .password-medium {
            background: #f59e0b;
            width: 50%;
        }
        
        .password-strong {
            background: #10b981;
            width: 75%;
        }
        
        .password-very-strong {
            background: #6366f1;
            width: 100%;
        }
        
        .password-toggle {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #9ca3af;
            cursor: pointer;
            padding: 4px;
        }
        
        .password-toggle:hover {
            color: #6366f1;
        }
        /* Phone validation styles */
.phone-input-container {
    position: relative;
}

.phone-validation {
    font-size: 0.75rem;
    margin-top: 0.25rem;
    transition: all 0.3s ease;
}

.phone-validation.valid {
    color: #10b981;
}

.phone-validation.invalid {
    color: #ef4444;
}

.phone-suggestions {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: rgba(177, 18, 18, 0.95);
    border: 1px solid rgba(99, 102, 241, 0.3);
    border-radius: 0.5rem;
    margin-top: 0.25rem;
    z-index: 50;
    backdrop-filter: blur(10px);
    max-height: 200px;
    overflow-y: auto;
    display: none;
}

.phone-suggestion-item {
    padding: 0.5rem 1rem;
    cursor: pointer;
    transition: background 0.2s ease;
}

.phone-suggestion-item:hover {
    background: rgba(99, 102, 241, 0.1);
}

.country-code-selector {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: #e8e8e8;
}

.country-code-selector select {
    background: #1d1d1d;
    border: none;
    color: rgb(242, 242, 242);
    appearance: none;
    cursor: pointer;
}

.country-code-selector select:focus {
    outline: none;
}

.country-flag {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    object-fit: cover;
}
    </style>
</head>
<body class="bg-black text-white">
    <!-- Header with Logo -->
    <header class="sticky top-0 z-50 bg-gray-900/90 backdrop-blur-sm border-b border-gray-800">
        <div class="max-w-7xl mx-auto px-6 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-2">
                    <img src="Logo.png" alt="NeuroFace AI Logo" class="logo-img">
                </div>
                <a href="index.html" class="text-sm font-medium text-gray-300 hover:text-indigo-300 transition">
                    ‚Üê Back to Home
                </a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="min-h-screen bg-gradient pt-8 pb-16">
        <!-- Neural Network Background Lines -->
        <div class="absolute inset-0 overflow-hidden pointer-events-none">
            <div class="neural-line top-1/4" style="animation-delay: 0s;"></div>
            <div class="neural-line top-1/2" style="animation-delay: 1s;"></div>
            <div class="neural-line top-3/4" style="animation-delay: 2s;"></div>
        </div>
        
        <div class="max-w-4xl mx-auto px-6 relative z-10">
            <!-- Progress Bar -->
            <div class="mb-10">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-sm font-medium text-gray-300">Step 1: Institution Details</span>
                    <span class="text-sm font-medium text-gray-300">Step 2: Payment</span>
                </div>
                <div class="progress-bar">
                    <div id="progressFill" class="progress-fill" style="width: 50%;"></div>
                </div>
            </div>

            <!-- Registration Form -->
            <div class="feature-card rounded-2xl p-8">
                <div class="text-center mb-10">
                    <h1 class="font-display text-3xl md:text-4xl font-bold mb-3">
                        Institution <span class="text-gradient">Registration</span>
                    </h1>
                    <p class="text-gray-400 max-w-2xl mx-auto">
                        Complete your registration to start using NeuroFace AI for smart attendance management.
                    </p>
                </div>

                <form id="registrationForm" class="space-y-8">
                    <!-- Step 1: Institution Details -->
                    <div id="step1" class="form-step active space-y-8">
                        <h2 class="text-2xl font-semibold mb-6 text-white">Institution Information</h2>
                        
                        <!-- Institute ID (Auto-generated or Manual) -->
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2" for="instituteId">
                                    Institute ID <span class="text-red-400">*</span>
                                </label>
                                <div class="flex space-x-3">
                                    <input type="text" id="instituteId" name="instituteId"
                                           class="w-full px-4 py-3 rounded-lg bg-gray-900 border border-gray-700 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"
                                           placeholder="INST001"
                                           required>
                                    <button type="button" onclick="generateInstituteId()"
                                            class="btn-secondary px-4 py-3 rounded-lg text-sm font-medium whitespace-nowrap">
                                        Generate ID
                                    </button>
                                </div>
                                <p class="text-xs text-gray-400 mt-1">Your unique identifier for the system</p>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2" for="instituteName">
                                    Institute Name <span class="text-red-400">*</span>
                                </label>
                                <input type="text" id="instituteName" name="instituteName"
                                       class="w-full px-4 py-3 rounded-lg bg-gray-900 border border-gray-700 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"
                                       placeholder="University of Technology"
                                       required>
                            </div>
                        </div>

                        <!-- Address Fields -->
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2" for="address">
                                Full Address <span class="text-red-400">*</span>
                            </label>
                            <textarea id="address" name="address" rows="3"
                                      class="w-full px-4 py-3 rounded-lg bg-gray-900 border border-gray-700 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 resize-none"
                                      placeholder="Building Name, Street, City, State, Pincode"
                                      required></textarea>
                        </div>

                        <!-- Contact Information -->
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2" for="email">
                                    Official Email <span class="text-red-400">*</span>
                                </label>
                                <input type="email" id="email" name="email"
                                       class="w-full px-4 py-3 rounded-lg bg-gray-900 border border-gray-700 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"
                                       placeholder="admin@institute.edu"
                                       required>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2" for="phone">
                                    Phone Number <span class="text-red-400">*</span>
                                </label>
                                <div class="phone-input-container">
                                    <input type="tel" id="phone" name="phone"
                                        class="w-full px-24 py-3 rounded-lg bg-gray-900 border border-gray-700 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 pl-32"
                                        placeholder="98765 43210"
                                        required
                                        oninput="validatePhoneNumber()"
                                        onblur="formatPhoneNumber()">
                                    
                                    <!-- Country Code Selector -->
                                    <div class="country-code-selector">
                                        <select id="countryCode" onchange="updateCountryCode()" class="text-sm">
                                            <option value="+91" selected>+91 IN</option>
                                            <option value="+1" >+1 US</option>
                                            <option value="+44">+44 UK</option>
                                            <option value="+61">+61 AU</option>
                                            <option value="+65">+65 SG</option>
                                            <option value="+971">+971 AE</option>
                                            <option value="+60">+60 MY</option>
                                            <option value="other">Other</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- Validation Message -->
                                <div id="phoneValidation" class="phone-validation"></div>
                                
                                <!-- Suggestions Container -->
                                <div id="phoneSuggestions" class="phone-suggestions"></div>
                                
                                <!-- Custom Country Code Input (hidden by default) -->
                                <div id="customCountryCodeContainer" class="mt-2 hidden">
                                    <label class="block text-xs font-medium text-gray-400 mb-1">
                                        Custom Country Code
                                    </label>
                                    <div class="flex space-x-2">
                                        <input type="text" id="customCountryCode" 
                                            class="w-24 px-3 py-2 rounded-lg bg-gray-900 border border-gray-700 text-white focus:border-indigo-500"
                                            placeholder="+123"
                                            maxlength="5">
                                        <input type="text" id="customPhoneNumber"
                                            class="flex-1 px-3 py-2 rounded-lg bg-gray-900 border border-gray-700 text-white focus:border-indigo-500"
                                            placeholder="Phone number">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Password Section -->
                        <div class="bg-gray-900/50 rounded-xl p-6">
                            <h3 class="text-lg font-semibold mb-4 text-white">Create Account Password</h3>
                            <p class="text-sm text-gray-400 mb-6">Create a strong password to secure your institution's account.</p>
                            
                            <div class="grid md:grid-cols-2 gap-6">
                                <!-- Password Field -->
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-2" for="password">
                                        Password <span class="text-red-400">*</span>
                                    </label>
                                    <div class="relative">
                                        <input type="password" id="password" name="password"
                                               class="w-full px-4 py-3 rounded-lg bg-gray-900 border border-gray-700 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 pr-10"
                                               placeholder="Create a strong password"
                                               required
                                               oninput="validatePassword()">
                                        <button type="button" class="password-toggle" onclick="togglePasswordVisibility('password', this)">
                                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                                            </svg>
                                        </button>
                                    </div>
                                    
                                    <!-- Password Strength Meter -->
                                    <div class="password-strength">
                                        <div id="passwordStrength" class="password-strength-fill"></div>
                                    </div>
                                    <div id="passwordStrengthText" class="text-xs mt-1 text-gray-400"></div>
                                </div>
                                
                                <!-- Confirm Password Field -->
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-2" for="confirmPassword">
                                        Confirm Password <span class="text-red-400">*</span>
                                    </label>
                                    <div class="relative">
                                        <input type="password" id="confirmPassword" name="confirmPassword"
                                               class="w-full px-4 py-3 rounded-lg bg-gray-900 border border-gray-700 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 pr-10"
                                               placeholder="Confirm your password"
                                               required
                                               oninput="validatePasswordMatch()">
                                        <button type="button" class="password-toggle" onclick="togglePasswordVisibility('confirmPassword', this)">
                                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                                            </svg>
                                        </button>
                                    </div>
                                    <div id="passwordMatchMessage" class="text-xs mt-1"></div>
                                </div>
                            </div>
                            
                            <!-- Password Rules -->
                            <div class="mt-6">
                                <p class="text-sm font-medium text-gray-300 mb-3">Password must contain:</p>
                                <div class="grid md:grid-cols-2 gap-2 text-sm">
                                    <div id="ruleLength" class="password-rule flex items-center">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                        </svg>
                                        At least 8 characters
                                    </div>
                                    <div id="ruleUppercase" class="password-rule flex items-center">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                        </svg>
                                        One uppercase letter (A-Z)
                                    </div>
                                    <div id="ruleLowercase" class="password-rule flex items-center">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                        </svg>
                                        One lowercase letter (a-z)
                                    </div>
                                    <div id="ruleNumber" class="password-rule flex items-center">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                        </svg>
                                        One number (0-9)
                                    </div>
                                    <div id="ruleSpecial" class="password-rule flex items-center">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                        </svg>
                                        One special character (!@#$%^&*)
                                    </div>
                                    <div id="ruleNoSpaces" class="password-rule flex items-center">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 01118 0z"/>
                                        </svg>
                                        No spaces allowed
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Security Tips -->
                            <div class="mt-6 p-4 bg-indigo-900/20 rounded-lg border border-indigo-500/30">
                                <p class="text-sm text-indigo-300 font-medium mb-1">üîí Security Tips:</p>
                                <ul class="text-xs text-indigo-200/80 space-y-1">
                                    <li>‚Ä¢ Use a unique password not used for other accounts</li>
                                    <li>‚Ä¢ Consider using a password manager</li>
                                    <li>‚Ä¢ Change your password every 90 days</li>
                                    <li>‚Ä¢ Never share your password with anyone</li>
                                </ul>
                            </div>
                        </div>

                        <!-- Additional Information -->
                        <div class="grid md:grid-cols-3 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2" for="instituteType">
                                    Institute Type <span class="text-red-400">*</span>
                                </label>
                                <select id="instituteType" name="instituteType"
                                        class="w-full px-4 py-3 rounded-lg bg-gray-900 border border-gray-700 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"
                                        required>
                                    <option value="" disabled selected>Select type</option>
                                    <option value="university">University</option>
                                    <option value="college">College</option>
                                    <option value="school">School</option>
                                    <option value="training">Training Center</option>
                                    <option value="corporate">Corporate</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2" for="studentCount">
                                    Approx. Students <span class="text-red-400">*</span>
                                </label>
                                <input type="number" id="studentCount" name="studentCount"
                                       class="w-full px-4 py-3 rounded-lg bg-gray-900 border border-gray-700 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"
                                       placeholder="500"
                                       min="1"
                                       required>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2" for="contactPerson">
                                    Contact Person <span class="text-red-400">*</span>
                                </label>
                                <input type="text" id="contactPerson" name="contactPerson"
                                       class="w-full px-4 py-3 rounded-lg bg-gray-900 border border-gray-700 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"
                                       placeholder="John Doe"
                                       required>
                            </div>
                        </div>

                        <!-- Form Navigation -->
                        <div class="flex justify-end pt-6">
                            <button type="button" onclick="nextStep()"
                                    class="btn-primary px-8 py-3 rounded-lg text-white font-semibold hover:shadow-xl transition-all duration-300">
                                Continue to Payment ‚Üí
                            </button>
                        </div>
                    </div>

                    <!-- Step 2: Payment -->
                    <div id="step2" class="form-step hidden space-y-8">
                        <!-- (Keep the existing Step 2 content exactly as it was) -->
                        <h2 class="text-2xl font-semibold mb-6 text-white">Select Payment Plan</h2>
                        
                        <!-- Summary of Details -->
                        <div class="bg-gray-900/50 rounded-xl p-6 mb-6">
                            <h3 class="text-lg font-semibold mb-4 text-gray-300">Registration Summary</h3>
                            <div class="grid md:grid-cols-2 gap-4 text-sm">
                                <div>
                                    <p class="text-gray-400">Institute ID:</p>
                                    <p class="font-medium" id="summaryId">-</p>
                                </div>
                                <div>
                                    <p class="text-gray-400">Institute Name:</p>
                                    <p class="font-medium" id="summaryName">-</p>
                                </div>
                                <div>
                                    <p class="text-gray-400">Email:</p>
                                    <p class="font-medium" id="summaryEmail">-</p>
                                </div>
                                <div>
                                    <p class="text-gray-400">Contact Person:</p>
                                    <p class="font-medium" id="summaryContact">-</p>
                                </div>
                            </div>
                        </div>

                        <!-- Payment Options -->
                        <div class="space-y-4">
                            <!-- Monthly Plan -->
                            <div id="monthlyPlan" class="payment-card rounded-xl p-6 cursor-pointer transition-all duration-300"
                                 onclick="selectPlan('monthly')">
                                <div class="flex justify-between items-start mb-4">
                                    <div>
                                        <h3 class="text-xl font-semibold text-white mb-1">Monthly Plan</h3>
                                        <p class="text-gray-400 text-sm">Pay as you go, cancel anytime</p>
                                    </div>
                                    <div class="text-right">
                                        <div class="text-2xl font-bold text-white">‚Çπ5,000</div>
                                        <div class="text-gray-400 text-sm">per month</div>
                                    </div>
                                </div>
                                <div class="space-y-2 text-sm text-gray-300">
                                    <div class="flex items-center">
                                        <svg class="w-4 h-4 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                                        </svg>
                                        <span>No long-term commitment</span>
                                    </div>
                                    <div class="flex items-center">
                                        <svg class="w-4 h-4 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                                        </svg>
                                        <span>All Professional features</span>
                                    </div>
                                    <div class="flex items-center">
                                        <svg class="w-4 h-4 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                                        </svg>
                                        <span>Monthly billing cycle</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Annual Plan -->
                            <div id="annualPlan" class="payment-card rounded-xl p-6 cursor-pointer border-2 border-indigo-500 selected"
                                 onclick="selectPlan('annual')">
                                <div class="flex justify-between items-start mb-4">
                                    <div>
                                        <div class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-indigo-500/20 text-indigo-300 mb-2">
                                            Most Popular
                                        </div>
                                        <h3 class="text-xl font-semibold text-white mb-1">Annual Plan</h3>
                                        <p class="text-gray-400 text-sm">Best value for institutions</p>
                                    </div>
                                    <div class="text-right">
                                        <div class="text-2xl font-bold text-white">‚Çπ50,000</div>
                                        <div class="text-gray-400 text-sm">per year (‚Çπ4,167/month)</div>
                                    </div>
                                </div>
                                <div class="space-y-2 text-sm text-gray-300">
                                    <div class="flex items-center">
                                        <svg class="w-4 h-4 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                                        </svg>
                                        <span><span class="font-semibold">Save 20%</span> compared to monthly</span>
                                    </div>
                                    <div class="flex items-center">
                                        <svg class="w-4 h-4 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                                        </svg>
                                        <span>All Professional features</span>
                                    </div>
                                    <div class="flex items-center">
                                        <svg class="w-4 h-4 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                                        </svg>
                                        <span>Priority feature requests</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Payment Method -->
                        <div class="mt-8">
                            <h3 class="text-lg font-semibold mb-4 text-white">Payment Method</h3>
                            <div class="grid md:grid-cols-3 gap-4 mb-6">
                                <div class="payment-card rounded-xl p-4 text-center cursor-pointer"
                                     onclick="selectPayment('card')">
                                    <div class="w-12 h-12 bg-indigo-500/20 rounded-full flex items-center justify-center mx-auto mb-3">
                                        <svg class="w-6 h-6 text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/>
                                        </svg>
                                    </div>
                                    <span class="text-sm font-medium">Credit/Debit Card</span>
                                </div>
                                
                                <div class="payment-card rounded-xl p-4 text-center cursor-pointer"
                                     onclick="selectPayment('upi')">
                                    <div class="w-12 h-12 bg-indigo-500/20 rounded-full flex items-center justify-center mx-auto mb-3">
                                        <svg class="w-6 h-6 text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"/>
                                        </svg>
                                    </div>
                                    <span class="text-sm font-medium">UPI</span>
                                </div>
                                
                                <div class="payment-card rounded-xl p-4 text-center cursor-pointer"
                                     onclick="selectPayment('netbanking')">
                                    <div class="w-12 h-12 bg-indigo-500/20 rounded-full flex items-center justify-center mx-auto mb-3">
                                        <svg class="w-6 h-6 text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/>
                                        </svg>
                                    </div>
                                    <span class="text-sm font-medium">Net Banking</span>
                                </div>
                            </div>
                            
                            <!-- Payment Method Forms -->
                            <div id="paymentForms" class="space-y-6">
                                <!-- Card Payment Form -->
                                <div id="cardForm" class="payment-method-form">
                                    <div class="bg-gray-900/50 rounded-xl p-6">
                                        <h4 class="text-lg font-semibold mb-4 text-white">Card Details</h4>
                                        <div class="space-y-4">
                                            <div>
                                                <label class="block text-sm font-medium text-gray-300 mb-2">
                                                    Card Number <span class="text-red-400">*</span>
                                                </label>
                                                <input type="text" id="cardNumber" name="cardNumber"
                                                       class="w-full px-4 py-3 rounded-lg bg-gray-900 border border-gray-700 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"
                                                       placeholder="1234 5678 9012 3456"
                                                       maxlength="19"
                                                       oninput="formatCardNumber(this)">
                                            </div>
                                            <div class="grid md:grid-cols-2 gap-4">
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-300 mb-2">
                                                        Expiry Date <span class="text-red-400">*</span>
                                                    </label>
                                                    <input type="text" id="expiryDate" name="expiryDate"
                                                           class="w-full px-4 py-3 rounded-lg bg-gray-900 border border-gray-700 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"
                                                           placeholder="MM/YY"
                                                           maxlength="5"
                                                           oninput="formatExpiryDate(this)">
                                                </div>
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-300 mb-2">
                                                        CVV <span class="text-red-400">*</span>
                                                    </label>
                                                    <input type="password" id="cvv" name="cvv"
                                                           class="w-full px-4 py-3 rounded-lg bg-gray-900 border border-gray-700 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"
                                                           placeholder="123"
                                                           maxlength="4">
                                                </div>
                                            </div>
                                            <div>
                                                <label class="block text-sm font-medium text-gray-300 mb-2">
                                                    Name on Card <span class="text-red-400">*</span>
                                                </label>
                                                <input type="text" id="cardName" name="cardName"
                                                       class="w-full px-4 py-3 rounded-lg bg-gray-900 border border-gray-700 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"
                                                       placeholder="John Doe">
                                            </div>
                                            <div class="flex items-center">
                                                <input type="checkbox" id="saveCard" name="saveCard"
                                                       class="w-4 h-4 text-indigo-600 bg-gray-900 border-gray-700 rounded focus:ring-indigo-500 focus:ring-2">
                                                <label for="saveCard" class="ml-2 text-sm text-gray-300">
                                                    Save card for future payments (secured with encryption)
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- UPI Payment Form -->
                                <div id="upiForm" class="payment-method-form">
                                    <div class="bg-gray-900/50 rounded-xl p-6">
                                        <h4 class="text-lg font-semibold mb-4 text-white">UPI Payment</h4>
                                        <div class="space-y-4">
                                            <div>
                                                <label class="block text-sm font-medium text-gray-300 mb-2">
                                                    UPI ID <span class="text-red-400">*</span>
                                                </label>
                                                <input type="text" id="upiId" name="upiId"
                                                       class="w-full px-4 py-3 rounded-lg bg-gray-900 border border-gray-700 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"
                                                       placeholder="username@upi">
                                            </div>
                                            <div class="mt-4">
                                                <p class="text-sm text-gray-400 mb-3">Or pay using:</p>
                                                <div class="grid grid-cols-4 gap-3">
                                                    <button type="button" class="py-3 bg-gray-800 rounded-lg hover:bg-gray-700 transition">
                                                        <div class="text-xs">Google Pay</div>
                                                    </button>
                                                    <button type="button" class="py-3 bg-gray-800 rounded-lg hover:bg-gray-700 transition">
                                                        <div class="text-xs">PhonePe</div>
                                                    </button>
                                                    <button type="button" class="py-3 bg-gray-800 rounded-lg hover:bg-gray-700 transition">
                                                        <div class="text-xs">Paytm</div>
                                                    </button>
                                                    <button type="button" class="py-3 bg-gray-800 rounded-lg hover:bg-gray-700 transition">
                                                        <div class="text-xs">BHIM</div>
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="mt-4 text-sm text-gray-400">
                                                <p>‚Ä¢ Enter your UPI ID and click "Pay Now"</p>
                                                <p>‚Ä¢ You'll receive a payment request on your UPI app</p>
                                                <p>‚Ä¢ Confirm the payment to complete registration</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Net Banking Form -->
                                <div id="netbankingForm" class="payment-method-form">
                                    <div class="bg-gray-900/50 rounded-xl p-6">
                                        <h4 class="text-lg font-semibold mb-4 text-white">Net Banking</h4>
                                        <div class="space-y-4">
                                            <div>
                                                <label class="block text-sm font-medium text-gray-300 mb-2">
                                                    Select Bank <span class="text-red-400">*</span>
                                                </label>
                                                <select id="bankName" name="bankName"
                                                        class="w-full px-4 py-3 rounded-lg bg-gray-900 border border-gray-700 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500">
                                                    <option value="" disabled selected>Choose your bank</option>
                                                    <option value="sbi">State Bank of India</option>
                                                    <option value="hdfc">HDFC Bank</option>
                                                    <option value="icici">ICICI Bank</option>
                                                    <option value="axis">Axis Bank</option>
                                                    <option value="kotak">Kotak Mahindra Bank</option>
                                                    <option value="pnb">Punjab National Bank</option>
                                                    <option value="bob">Bank of Baroda</option>
                                                    <option value="yes">Yes Bank</option>
                                                    <option value="indusind">IndusInd Bank</option>
                                                    <option value="idfc">IDFC First Bank</option>
                                                </select>
                                            </div>
                                            <div class="mt-4">
                                                <div class="grid grid-cols-3 gap-3">
                                                    <div class="text-center p-3 bg-gray-800 rounded-lg">
                                                        <div class="text-xs mb-1">SBI</div>
                                                        <div class="text-xs text-gray-400">State Bank</div>
                                                    </div>
                                                    <div class="text-center p-3 bg-gray-800 rounded-lg">
                                                        <div class="text-xs mb-1">HDFC</div>
                                                        <div class="text-xs text-gray-400">HDFC Bank</div>
                                                    </div>
                                                    <div class="text-center p-3 bg-gray-800 rounded-lg">
                                                        <div class="text-xs mb-1">ICICI</div>
                                                        <div class="text-xs text-gray-400">ICICI Bank</div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="mt-4 text-sm text-gray-400">
                                                <p>‚Ä¢ You will be redirected to your bank's secure payment page</p>
                                                <p>‚Ä¢ Login with your net banking credentials</p>
                                                <p>‚Ä¢ Complete the payment to finish registration</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Terms and Conditions -->
                            <div class="mt-6">
                                <label class="flex items-start">
                                    <input type="checkbox" id="terms" name="terms"
                                           class="mt-1 mr-3 w-4 h-4 text-indigo-600 bg-gray-900 border-gray-700 rounded focus:ring-indigo-500 focus:ring-2">
                                    <span class="text-sm text-gray-300">
                                        I agree to the <a href="#" class="text-indigo-400 hover:text-indigo-300">Terms of Service</a> and 
                                        <a href="#" class="text-indigo-400 hover:text-indigo-300">Privacy Policy</a>. I understand that my 
                                        registration will be activated after successful payment.
                                    </span>
                                </label>
                            </div>
                        </div>

                        <!-- Payment Navigation -->
                        <div class="flex justify-between pt-8">
                            <button type="button" onclick="prevStep()"
                                    class="btn-secondary px-8 py-3 rounded-lg text-white font-semibold hover:shadow-xl transition-all duration-300">
                                ‚Üê Back
                            </button>
                            <button type="button" onclick="processPayment()"
                                    id="payButton"
                                    class="btn-primary px-8 py-3 rounded-lg text-white font-semibold hover:shadow-xl transition-all duration-300 flex items-center">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                                </svg>
                                Pay ‚Çπ50,000 & Complete Registration
                            </button>
                        </div>
                    </div>
                </form>

                <!-- Support Information -->
                <div class="mt-12 pt-8 border-t border-gray-800">
                    <div class="flex flex-col md:flex-row items-center justify-between">
                        <div class="flex items-center mb-4 md:mb-0">
                            <div class="w-10 h-10 bg-indigo-500/20 rounded-full flex items-center justify-center mr-3">
                                <svg class="w-5 h-5 text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192l-3.536 3.536M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                            </div>
                            <div>
                                <p class="text-sm font-medium">Need help with registration?</p>
                                <p class="text-sm text-indigo-400">Contact support: help@neurofaceai.com</p>
                            </div>
                        </div>
                        <a href="index.html#pricing" class="text-sm text-gray-400 hover:text-indigo-300 transition">
                            View all pricing plans ‚Üí
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-8">
        <div class="max-w-7xl mx-auto px-6">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="flex items-center mb-4 md:mb-0">
                    <img src="Logo.png" alt="NeuroFace AI Logo" class="h-10 w-auto mr-3">
                    <span class="font-display text-lg">NeuroFace AI</span>
                </div>
                <p class="text-gray-400 text-sm">
                    ¬© 2025 NeuroFace AI. All rights reserved.
                </p>
            </div>
        </div>
    </footer>

    <script>
        let currentStep = 1;
        let selectedPlan = 'annual';
        let selectedPayment = 'card';

        // Password validation functions
        function validatePassword() {
            const password = document.getElementById('password').value;
            const strengthBar = document.getElementById('passwordStrength');
            const strengthText = document.getElementById('passwordStrengthText');
            
            // Password rules validation
            const rules = {
                length: password.length >= 8,
                uppercase: /[A-Z]/.test(password),
                lowercase: /[a-z]/.test(password),
                number: /[0-9]/.test(password),
                special: /[!@#$%^&*]/.test(password),
                noSpaces: !/\s/.test(password)
            };
            
            // Update rule indicators
            Object.keys(rules).forEach(rule => {
                const element = document.getElementById(`rule${rule.charAt(0).toUpperCase() + rule.slice(1)}`);
                if (element) {
                    element.classList.remove('valid', 'invalid');
                    element.classList.add(rules[rule] ? 'valid' : 'invalid');
                }
            });
            
            // Calculate password strength
            let score = 0;
            if (rules.length) score++;
            if (rules.uppercase) score++;
            if (rules.lowercase) score++;
            if (rules.number) score++;
            if (rules.special) score++;
            if (rules.noSpaces) score++;
            
            // Update strength meter
            strengthBar.className = 'password-strength-fill';
            let strengthClass = 'password-weak';
            let text = 'Weak';
            
            if (score >= 5) {
                strengthClass = 'password-very-strong';
                text = 'Very Strong';
            } else if (score >= 4) {
                strengthClass = 'password-strong';
                text = 'Strong';
            } else if (score >= 3) {
                strengthClass = 'password-medium';
                text = 'Medium';
            }
            
            strengthBar.classList.add(strengthClass);
            strengthText.textContent = `Password strength: ${text}`;
            strengthText.className = `text-xs mt-1 ${strengthClass === 'password-weak' ? 'text-red-400' : 
                                      strengthClass === 'password-medium' ? 'text-yellow-400' : 
                                      strengthClass === 'password-strong' ? 'text-green-400' : 'text-indigo-400'}`;
            
            // Validate password match
            validatePasswordMatch();
            
            return score >= 3; // At least medium strength
        }

        function validatePasswordMatch() {
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const messageElement = document.getElementById('passwordMatchMessage');
            
            if (confirmPassword === '') {
                messageElement.textContent = '';
                messageElement.className = 'text-xs mt-1';
                return false;
            }
            
            if (password === confirmPassword) {
                messageElement.textContent = '‚úì Passwords match';
                messageElement.className = 'text-xs mt-1 text-green-400';
                return true;
            } else {
                messageElement.textContent = '‚úó Passwords do not match';
                messageElement.className = 'text-xs mt-1 text-red-400';
                return false;
            }
        }

        function togglePasswordVisibility(fieldId, button) {
            const field = document.getElementById(fieldId);
            const icon = button.querySelector('svg');
            
            if (field.type === 'password') {
                field.type = 'text';
                icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L6.59 6.59m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"/>';
            } else {
                field.type = 'password';
                icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>';
            }
        }

        function generateInstituteId() {
            const prefix = 'NEURO';
            const randomNum = Math.floor(1000 + Math.random() * 9000);
            const instituteId = prefix + randomNum;
            document.getElementById('instituteId').value = instituteId;
        }

        function selectPlan(plan) {
            selectedPlan = plan;
            
            // Update UI
            document.getElementById('monthlyPlan').classList.remove('selected');
            document.getElementById('annualPlan').classList.remove('selected');
            document.getElementById(plan + 'Plan').classList.add('selected');
            
            // Update payment button text
            const amount = plan === 'monthly' ? '5,000' : '50,000';
            document.getElementById('payButton').innerHTML = `
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                </svg>
                Pay ‚Çπ${amount} & Complete Registration
            `;
        }

        function selectPayment(method) {
            selectedPayment = method;
            
            // Remove active class from all payment method forms
            document.querySelectorAll('.payment-method-form').forEach(form => {
                form.classList.remove('active');
            });
            
            // Add active class to selected payment method form
            document.getElementById(method + 'Form').classList.add('active');
            
            // Update UI for payment method selection
            document.querySelectorAll('.payment-card').forEach(card => {
                card.classList.remove('border-indigo-500', 'selected');
                if (card.onclick && card.onclick.toString().includes(method)) {
                    card.classList.add('border-indigo-500', 'selected');
                }
            });
        }

        function formatCardNumber(input) {
            // Remove all non-digits
            let value = input.value.replace(/\D/g, '');
            
            // Format with spaces every 4 digits
            let formatted = '';
            for (let i = 0; i < value.length; i++) {
                if (i > 0 && i % 4 === 0) {
                    formatted += ' ';
                }
                formatted += value[i];
            }
            
            // Limit to 16 digits
            if (value.length > 16) {
                value = value.substring(0, 16);
            }
            
            input.value = formatted;
        }

        function formatExpiryDate(input) {
            let value = input.value.replace(/\D/g, '');
            
            if (value.length >= 2) {
                value = value.substring(0, 2) + '/' + value.substring(2, 4);
            }
            
            if (value.length > 5) {
                value = value.substring(0, 5);
            }
            
            input.value = value;
        }

        function nextStep() {
            // Validate step 1 including password
            const requiredFields = [
                'instituteId', 'instituteName', 'address', 'email', 'phone', 
                'instituteType', 'studentCount', 'contactPerson', 'password', 'confirmPassword'
            ];
            
            let isValid = true;
            
            // Validate basic fields
            requiredFields.forEach(field => {
                const element = document.getElementById(field);
                if (!element.value.trim()) {
                    element.classList.add('border-red-500');
                    isValid = false;
                } else {
                    element.classList.remove('border-red-500');
                }
            });
            
            // Validate password strength
            if (!validatePassword()) {
                document.getElementById('password').classList.add('border-red-500');
                alert('Please create a stronger password (at least medium strength).');
                isValid = false;
            }
            
            // Validate password match
            if (!validatePasswordMatch()) {
                document.getElementById('confirmPassword').classList.add('border-red-500');
                alert('Passwords do not match. Please confirm your password.');
                isValid = false;
            }
            if (!validatePhoneNumber()) {
                alert('Please enter a valid phone number.');
                document.getElementById('phone').focus();
                return;
            }
            
            if (!isValid) {
                alert('Please fill in all required fields and ensure passwords meet requirements.');
                return;
            }
            
            // Update summary
            document.getElementById('summaryId').textContent = document.getElementById('instituteId').value;
            document.getElementById('summaryName').textContent = document.getElementById('instituteName').value;
            document.getElementById('summaryEmail').textContent = document.getElementById('email').value;
            document.getElementById('summaryContact').textContent = document.getElementById('contactPerson').value;
            
            // Switch steps
            document.getElementById('step1').classList.remove('active');
            document.getElementById('step2').classList.remove('hidden');
            document.getElementById('step2').classList.add('active');
            
            // Update progress
            document.getElementById('progressFill').style.width = '100%';
            document.querySelectorAll('.progress-bar span')[0].textContent = 'Step 2: Payment';
            currentStep = 2;
        }

        function prevStep() {
            document.getElementById('step2').classList.remove('active');
            document.getElementById('step2').classList.add('hidden');
            document.getElementById('step1').classList.add('active');
            
            // Update progress
            document.getElementById('progressFill').style.width = '50%';
            document.querySelectorAll('.progress-bar span')[0].textContent = 'Step 1: Institution Details';
            currentStep = 1;
        }

        function validatePayment() {
            let isValid = true;
            
            if (selectedPayment === 'card') {
                const cardNumber = document.getElementById('cardNumber').value.replace(/\s/g, '');
                const expiryDate = document.getElementById('expiryDate').value;
                const cvv = document.getElementById('cvv').value;
                const cardName = document.getElementById('cardName').value;
                
                if (cardNumber.length !== 16) {
                    alert('Please enter a valid 16-digit card number.');
                    isValid = false;
                }
                if (!expiryDate.match(/^(0[1-9]|1[0-2])\/([0-9]{2})$/)) {
                    alert('Please enter a valid expiry date (MM/YY).');
                    isValid = false;
                }
                if (cvv.length < 3 || cvv.length > 4) {
                    alert('Please enter a valid CVV (3-4 digits).');
                    isValid = false;
                }
                if (!cardName.trim()) {
                    alert('Please enter the name on card.');
                    isValid = false;
                }
            } else if (selectedPayment === 'upi') {
                const upiId = document.getElementById('upiId').value;
                if (!upiId.match(/^[a-zA-Z0-9.\-_]{2,49}@[a-zA-Z]{2,}$/)) {
                    alert('Please enter a valid UPI ID (e.g., username@upi).');
                    isValid = false;
                }
            } else if (selectedPayment === 'netbanking') {
                const bankName = document.getElementById('bankName').value;
                if (!bankName) {
                    alert('Please select your bank.');
                    isValid = false;
                }
            }
            
            return isValid;
        }

        async function submitRegistrationToBackend() {
            const payload = {
                instituteId: document.getElementById("instituteId").value,
                instituteName: document.getElementById("instituteName").value,
                address: document.getElementById("address").value,
                email: document.getElementById("email").value,
                phone: document.getElementById("phone").value,
                instituteType: document.getElementById("instituteType").value,
                studentCount: Number(document.getElementById("studentCount").value),
                contactPerson: document.getElementById("contactPerson").value,
                subscriptionPlan: selectedPlan,
                paymentMethod: selectedPayment,
                password: document.getElementById("password").value
            };

            try {
                console.log("Sending registration data:", payload);
                
                const response = await fetch("http://127.0.0.1:8000/institutes/register", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(payload)
                });

                console.log("Response status:", response.status);
                const data = await response.json();
                console.log("Response data:", data);

                if (!response.ok) {
                    alert(data.detail || "Registration failed");
                    return false;
                }
                
                console.log("Backend registration successful!");
                return true;

            } catch (error) {
                console.error("Error:", error);
                alert("Server error. Please try again later.");
                return false;
            }
        }

        function processPayment() {
            // Validate terms
            if (!document.getElementById('terms').checked) {
                alert('Please accept the Terms and Conditions to proceed.');
                return;
            }
            
            // Validate password strength
            if (!validatePassword()) {
                alert('Please ensure your password meets all requirements.');
                return;
            }
            
            // Validate password match
            if (!validatePasswordMatch()) {
                alert('Passwords do not match.');
                return;
            }
            
            // Validate payment details
            if (!validatePayment()) {
                return;
            }
            
            // Show processing animation
            const payButton = document.getElementById('payButton');
            const originalText = payButton.innerHTML;
            payButton.innerHTML = `
                <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                Processing Payment...
            `;
            payButton.disabled = true;
            
            // Call backend first, then show success
            submitRegistrationToBackend().then(success => {
                console.log("Backend registration result:", success);
                
                if (success) {
                    // Reset form and show success message
                    document.getElementById('registrationForm').reset();
                    
                    // Don't call prevStep() here - it hides the payment section
                    // prevStep(); // Remove this line
                    
                    // Show success modal
                    showSuccessMessage();
                }
                
                // Reset button state
                payButton.innerHTML = originalText;
                payButton.disabled = false;
                
            }).catch(error => {
                console.error("Payment processing error:", error);
                alert("An error occurred during registration. Please try again.");
                payButton.innerHTML = originalText;
                payButton.disabled = false;
            });
        }

        function showSuccessMessage() {
            console.log("showSuccessMessage() called");
            
            // Remove any existing success modal first
            const existingModal = document.querySelector('.success-modal-container');
            if (existingModal) {
                existingModal.remove();
            }
            
            // Create success modal
            const modal = document.createElement('div');
            modal.className = 'success-modal-container fixed inset-0 bg-black/80 flex items-center justify-center z-[100]';
            modal.innerHTML = `
                <div class="bg-gray-900 rounded-2xl p-8 max-w-md w-full mx-4 border border-indigo-500/30 shadow-2xl">
                    <div class="w-20 h-20 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-6">
                        <svg class="w-10 h-10 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                        </svg>
                    </div>
                    <h3 class="text-2xl font-bold text-center mb-4 text-white">Registration Successful!</h3>
                    <p class="text-gray-300 text-center mb-6">
                        Thank you for registering with NeuroFace AI. Your account has been created and activated.
                    </p>
                    <div class="text-center space-y-3">
                        <button onclick="window.location.href='register.html'"
                                class="btn-primary w-full py-3 rounded-lg text-white font-semibold hover:shadow-xl transition-all duration-300">
                            Go to Login
                        </button>
                        <button onclick="closeSuccessModal()"
                                class="w-full py-3 border border-gray-700 text-gray-300 rounded-lg hover:bg-gray-800 transition">
                            Close
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            document.body.style.overflow = 'hidden'; // Prevent scrolling behind modal
            console.log("Success modal added to DOM");
        }

        function closeSuccessModal() {
            const modal = document.querySelector('.success-modal-container');
            if (modal) {
                modal.remove();
                document.body.style.overflow = 'auto'; // Restore scrolling
            }
        }

        // Also add event listeners for the modal buttons in the DOMContentLoaded event
        document.addEventListener('DOMContentLoaded', function() {
            generateInstituteId();
            selectPlan('annual');
            selectPayment('card');
            
            // Initialize password validation
            validatePassword();
            validatePasswordMatch();
            
            // Add global close modal function
            window.closeSuccessModal = closeSuccessModal;
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            generateInstituteId();
            selectPlan('annual');
            selectPayment('card');
            
            // Initialize password validation
            validatePassword();
            validatePasswordMatch();
        });
        // Phone validation state
let currentCountryCode = '+91';
let phoneSuggestions = [];

// Country code data
const countryCodes = {
    '+91': { name: 'India', pattern: /^(\+91)?[6-9]\d{9}$/, format: '+91 XXXXX XXXXX', example: '+91 98765 43210' },
    '+1': { name: 'USA/Canada', pattern: /^(\+1)?[2-9]\d{9}$/, format: '+1 (XXX) XXX-XXXX', example: '+1 (555) 123-4567' },
    '+44': { name: 'UK', pattern: /^(\+44)?7\d{9}$/, format: '+44 XX XXXX XXXX', example: '+44 79 1234 5678' },
    '+61': { name: 'Australia', pattern: /^(\+61)?4\d{8}$/, format: '+61 4XX XXX XXX', example: '+61 412 345 678' },
    '+65': { name: 'Singapore', pattern: /^(\+65)?[89]\d{7}$/, format: '+65 XXXX XXXX', example: '+65 8123 4567' },
    '+971': { name: 'UAE', pattern: /^(\+971)?5\d{8}$/, format: '+971 5X XXX XXXX', example: '+971 50 123 4567' },
    '+60': { name: 'Malaysia', pattern: /^(\+60)?1\d{8,9}$/, format: '+60 1X-XXXX XXXX', example: '+60 12-345 6789' }
};

function updateCountryCode() {
    const select = document.getElementById('countryCode');
    const customContainer = document.getElementById('customCountryCodeContainer');
    const phoneInput = document.getElementById('phone');
    
    if (select.value === 'other') {
        customContainer.classList.remove('hidden');
        phoneInput.classList.add('hidden');
        currentCountryCode = '';
    } else {
        customContainer.classList.add('hidden');
        phoneInput.classList.remove('hidden');
        currentCountryCode = select.value;
        phoneInput.placeholder = countryCodes[currentCountryCode]?.example.split(' ')[1] || 'Enter phone number';
        validatePhoneNumber();
    }
}

function validatePhoneNumber() {
    const phoneInput = document.getElementById('phone');
    const validationElement = document.getElementById('phoneValidation');
    const suggestionsElement = document.getElementById('phoneSuggestions');
    let phoneNumber = phoneInput.value.trim();
    
    // Clear previous validation
    validationElement.textContent = '';
    validationElement.className = 'phone-validation';
    suggestionsElement.style.display = 'none';
    phoneInput.classList.remove('border-red-500', 'border-green-500');
    
    if (!phoneNumber) {
        return false;
    }
    
    // Remove all non-digits except plus sign
    let cleanedNumber = phoneNumber.replace(/[^\d\+]/g, '');
    
    // Check if number already includes country code
    let numberToValidate = cleanedNumber;
    if (!cleanedNumber.startsWith('+')) {
        numberToValidate = currentCountryCode + cleanedNumber;
    }
    
    // Get country code info
    const countryInfo = countryCodes[currentCountryCode];
    let isValid = false;
    let formattedNumber = '';
    let message = '';
    
    if (countryInfo) {
        // Test against country pattern
        isValid = countryInfo.pattern.test(numberToValidate);
        
        if (isValid) {
            // Format the number
            formattedNumber = formatPhoneForCountry(numberToValidate, currentCountryCode);
            message = `‚úì Valid ${countryInfo.name} number`;
            phoneInput.classList.add('border-green-500');
            validationElement.classList.add('valid');
            
            // Update input with formatted number
            phoneInput.value = formattedNumber.replace(currentCountryCode + ' ', '');
        } else {
            message = `Please enter a valid ${countryInfo.name} phone number`;
            phoneInput.classList.add('border-red-500');
            validationElement.classList.add('invalid');
            
            // Show suggestions for corrections
            showPhoneSuggestions(cleanedNumber);
        }
    } else {
        // Generic validation for other countries
        isValid = /^\+?[1-9]\d{1,14}$/.test(numberToValidate);
        if (isValid && numberToValidate.length >= 8 && numberToValidate.length <= 15) {
            message = '‚úì Valid phone number';
            phoneInput.classList.add('border-green-500');
            validationElement.classList.add('valid');
        } else {
            message = 'Please enter a valid phone number (8-15 digits)';
            phoneInput.classList.add('border-red-500');
            validationElement.classList.add('invalid');
        }
    }
    
    validationElement.textContent = message;
    return isValid;
}

function formatPhoneNumber() {
    const phoneInput = document.getElementById('phone');
    let phoneNumber = phoneInput.value.trim();
    
    if (!phoneNumber) return;
    
    // Remove all non-digits
    let digits = phoneNumber.replace(/\D/g, '');
    
    // Format based on country code
    const countryInfo = countryCodes[currentCountryCode];
    
    if (countryInfo) {
        let formatted = '';
        const formatPattern = countryInfo.format.split(' ')[1] || 'XXXXXXXXXX';
        
        switch (currentCountryCode) {
            case '+91': // India
                if (digits.length <= 5) {
                    formatted = digits;
                } else if (digits.length <= 10) {
                    formatted = digits.replace(/(\d{5})(\d+)/, '$1 $2');
                }
                break;
                
            case '+1': // US/Canada
                if (digits.length <= 3) {
                    formatted = digits;
                } else if (digits.length <= 6) {
                    formatted = digits.replace(/(\d{3})(\d+)/, '($1) $2');
                } else {
                    formatted = digits.replace(/(\d{3})(\d{3})(\d+)/, '($1) $2-$3');
                }
                break;
                
            case '+44': // UK
                if (digits.length <= 2) {
                    formatted = digits;
                } else if (digits.length <= 6) {
                    formatted = digits.replace(/(\d{2})(\d+)/, '$1 $2');
                } else {
                    formatted = digits.replace(/(\d{2})(\d{4})(\d+)/, '$1 $2 $3');
                }
                break;
                
            default:
                // Generic formatting: add space after every 4 digits
                formatted = digits.replace(/(\d{4})(?=\d)/g, '$1 ');
        }
        
        phoneInput.value = formatted;
    }
}

function formatPhoneForCountry(phoneNumber, countryCode) {
    let digits = phoneNumber.replace(/\D/g, '');
    
    switch (countryCode) {
        case '+91': // India: +91 XXXXX XXXXX
            return `+91 ${digits.substring(0, 5)} ${digits.substring(5, 10)}`;
            
        case '+1': // US/Canada: +1 (XXX) XXX-XXXX
            return `+1 (${digits.substring(0, 3)}) ${digits.substring(3, 6)}-${digits.substring(6, 10)}`;
            
        case '+44': // UK: +44 XX XXXX XXXX
            return `+44 ${digits.substring(0, 2)} ${digits.substring(2, 6)} ${digits.substring(6, 10)}`;
            
        case '+61': // Australia: +61 4XX XXX XXX
            return `+61 ${digits.substring(0, 3)} ${digits.substring(3, 6)} ${digits.substring(6, 9)}`;
            
        case '+65': // Singapore: +65 XXXX XXXX
            return `+65 ${digits.substring(0, 4)} ${digits.substring(4, 8)}`;
            
        default:
            return `+${digits}`;
    }
}

function showPhoneSuggestions(inputDigits) {
    const suggestionsElement = document.getElementById('phoneSuggestions');
    const countryInfo = countryCodes[currentCountryCode];
    
    if (!countryInfo || inputDigits.length < 4) {
        suggestionsElement.style.display = 'none';
        return;
    }
    
    let suggestions = [];
    
    // Generate suggestions for common errors
    if (currentCountryCode === '+91') {
        // Indian number suggestions
        if (inputDigits.length === 10) {
            suggestions = [
                `+91 ${inputDigits.substring(0, 5)} ${inputDigits.substring(5)}`,
                `+91 ${inputDigits}`
            ];
        } else if (inputDigits.length < 10) {
            suggestions = [
                `Add ${10 - inputDigits.length} more digit(s)`,
                `Example: ${countryInfo.example}`
            ];
        } else {
            suggestions = [
                `Remove ${inputDigits.length - 10} extra digit(s)`,
                `Example: ${countryInfo.example}`
            ];
        }
    }
    
    if (suggestions.length > 0) {
        suggestionsElement.innerHTML = suggestions.map(suggestion => 
            `<div class="phone-suggestion-item" onclick="applyPhoneSuggestion('${suggestion.replace(currentCountryCode + ' ', '')}')">
                ${suggestion}
            </div>`
        ).join('');
        suggestionsElement.style.display = 'block';
    } else {
        suggestionsElement.style.display = 'none';
    }
}

function applyPhoneSuggestion(suggestion) {
    const phoneInput = document.getElementById('phone');
    const suggestionsElement = document.getElementById('phoneSuggestions');
    
    phoneInput.value = suggestion;
    suggestionsElement.style.display = 'none';
    validatePhoneNumber();
}

// Add this to your DOMContentLoaded event
document.addEventListener('DOMContentLoaded', function() {
    // ... existing code ...
    
    // Initialize phone validation
    updateCountryCode();
    
    // Close suggestions when clicking outside
    document.addEventListener('click', function(event) {
        const suggestions = document.getElementById('phoneSuggestions');
        const phoneInput = document.getElementById('phone');
        
        if (!phoneInput.contains(event.target) && !suggestions.contains(event.target)) {
            suggestions.style.display = 'none';
        }
    });
    
    // Also validate phone when country code changes
    document.getElementById('countryCode').addEventListener('change', validatePhoneNumber);
});
    </script>
</body>
</html>